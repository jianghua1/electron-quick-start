<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  </head>
  <body>
    <div id="app">
      <p>{{message}}</p>
      <input type="text" v-model="message" />
      <button @click="handleClick">setTitle</button>
    </div>
  </body>
  <script>
    const { createApp, ref } = Vue

    createApp({
      setup() {
        const message = ref('hello vue!')
        const handleClick = async () => {
          const txt = await window.electronAPI.setTitle(message.value)
          console.log(txt)
        }

        const handleReply = (event, data) => {
          console.log(data)
        }
        window.electronAPI.callFormMain(handleReply)
        return {
          message,
          handleClick
        }
      }
    }).mount('#app')

    document.addEventListener('contextmenu', (e) => {
      window.electronAPI.openMenu()
    })

    const checkInterval = setInterval(() => {
      if (window.electronAPI.reply) {
        clearInterval(checkInterval)
        window.electronAPI.reply((event, data) => {
          console.log('回调成功', event, data)
        })
      }
    }, 200)
  </script>
</html>
